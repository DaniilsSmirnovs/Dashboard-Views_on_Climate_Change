width = 6,
box(
selectInput(
inputId = "select_negative_impact_input",
label = "Select response(s) (Optional)",
choices = negative_impact_response_list,
selected = NULL,
multiple = TRUE),
selectInput(
inputId = "negative_impact_subgroups",
label = "Select Demographic Subgroup(s) (Optional)",
choices = select_subgroups$subgroup,
selected = "Overall Population",
multiple = TRUE
),
plotlyOutput("negative_impact"),
title = "Negative Impact",
width = NULL
)
)
)
)
)
)
shinyApp(ui, server)
ui <- dashboardPage(
dashboardHeader(title = "Views on Climate Change",
titleWidth = 400),
dashboardSidebar(
selectInput(
inputId = "select_parameter",
label = "Select Demographic Parameter",
choices = parameters_list,
selected = "Overall Population"
)
),
dashboardBody(
tags$head(
tags$style(HTML("
.skin-blue .main-header .logo {
background-color: #005eb8;
color: white;
}
.skin-blue .main-header .navbar {
background-color: #0078ec;
}
.skin-blue .main-sidebar {
background-color:  #d3d3d3;
}
"))
),
fluidPage(
fluidRow(
column(
width = 6,
box(
selectInput(
inputId = "select_knowledge_input",
label = "Select response(s) (Optional)",
choices = knowledge_response_list,
selected = NULL,
multiple = TRUE),
selectInput(
inputId = "knowledge_subgroups",
label = "Select Demographic Subgroup(s) (Optional)",
choices = select_subgroups$subgroup,
selected = NULL,
multiple = TRUE
),
plotlyOutput("knowledge"),
title = "Knowledge",
width = NULL
)
),
column(
width = 6,
box(
selectInput(
inputId = "select_urgency_input",
label = "Select statement",
choices = urgency_response_list,
selected = urgency_response_list[1]),
selectInput(
inputId = "urgency_subgroups",
label = "Select Demographic Subgroup(s) (Optional)",
choices = select_subgroups$subgroup,
selected = NULL,
multiple = TRUE
),
plotlyOutput("urgency"),
title = "Urgency",
width = NULL
)
)
),
fluidRow(
column(
width = 6,
box(
numericInput(
inputId = "select_topsources",
label = "Select number of most trusted sources to display",
value = 5, max = 11, min = 3, step =1
),
selectInput(
inputId = "sources_select_subgroups",
label = "Select Demographic Subgroup",
choices = select_subgroups$subgroup,
selected = "Overall Population"
),
plotlyOutput("sources"),
title = "Sources of Information",
width = NULL
)
),
column(
width = 6,
box(
selectInput(
inputId = "select_negative_impact_input",
label = "Select response(s) (Optional)",
choices = negative_impact_response_list,
selected = NULL,
multiple = TRUE),
selectInput(
inputId = "negative_impact_subgroups",
label = "Select Demographic Subgroup(s) (Optional)",
choices = select_subgroups$subgroup,
selected = "Overall Population",
multiple = TRUE
),
plotlyOutput("negative_impact"),
title = "Negative Impact",
width = NULL
)
)
)
)
)
)
shinyApp(ui, server)
ui <- dashboardPage(
dashboardHeader(title = "Views on Climate Change",
titleWidth = 400),
dashboardSidebar(
selectInput(
inputId = "select_parameter",
label = HTML('<p style="color:black;">Select Demographic Parameter</p>'),
choices = parameters_list,
selected = "Overall Population"
)
),
dashboardBody(
tags$head(
tags$style(HTML("
.skin-blue .main-header .logo {
background-color: #005eb8;
color: white;
}
.skin-blue .main-header .navbar {
background-color: #0078ec;
}
.skin-blue .main-sidebar {
background-color:  #d3d3d3;
}
"))
),
fluidPage(
fluidRow(
column(
width = 6,
box(
selectInput(
inputId = "select_knowledge_input",
label = "Select response(s) (Optional)",
choices = knowledge_response_list,
selected = NULL,
multiple = TRUE),
selectInput(
inputId = "knowledge_subgroups",
label = "Select Demographic Subgroup(s) (Optional)",
choices = select_subgroups$subgroup,
selected = NULL,
multiple = TRUE
),
plotlyOutput("knowledge"),
title = "Knowledge",
width = NULL
)
),
column(
width = 6,
box(
selectInput(
inputId = "select_urgency_input",
label = "Select statement",
choices = urgency_response_list,
selected = urgency_response_list[1]),
selectInput(
inputId = "urgency_subgroups",
label = "Select Demographic Subgroup(s) (Optional)",
choices = select_subgroups$subgroup,
selected = NULL,
multiple = TRUE
),
plotlyOutput("urgency"),
title = "Urgency",
width = NULL
)
)
),
fluidRow(
column(
width = 6,
box(
numericInput(
inputId = "select_topsources",
label = "Select number of most trusted sources to display",
value = 5, max = 11, min = 3, step =1
),
selectInput(
inputId = "sources_select_subgroups",
label = "Select Demographic Subgroup",
choices = select_subgroups$subgroup,
selected = "Overall Population"
),
plotlyOutput("sources"),
title = "Sources of Information",
width = NULL
)
),
column(
width = 6,
box(
selectInput(
inputId = "select_negative_impact_input",
label = "Select response(s) (Optional)",
choices = negative_impact_response_list,
selected = NULL,
multiple = TRUE),
selectInput(
inputId = "negative_impact_subgroups",
label = "Select Demographic Subgroup(s) (Optional)",
choices = select_subgroups$subgroup,
selected = "Overall Population",
multiple = TRUE
),
plotlyOutput("negative_impact"),
title = "Negative Impact",
width = NULL
)
)
)
)
)
)
shinyApp(ui, server)
ui <- dashboardPage(
dashboardHeader(title = "Views on Climate Change",
titleWidth = 400),
dashboardSidebar(
selectInput(
inputId = "select_parameter",
label = HTML('<p style="color:black;">Select Demographic Parameter</p>'),
choices = parameters_list,
selected = "Overall Population"
)
),
dashboardBody(
tags$head(
tags$style(HTML("
.skin-blue .main-header .logo {
background-color: #005eb8;
color: white;
}
.skin-blue .main-header .navbar {
background-color: #0078ec;
}
.skin-blue .main-sidebar {
background-color:  #e4e4e4;
}
"))
),
fluidPage(
fluidRow(
column(
width = 6,
box(
selectInput(
inputId = "select_knowledge_input",
label = "Select response(s) (Optional)",
choices = knowledge_response_list,
selected = NULL,
multiple = TRUE),
selectInput(
inputId = "knowledge_subgroups",
label = "Select Demographic Subgroup(s) (Optional)",
choices = select_subgroups$subgroup,
selected = NULL,
multiple = TRUE
),
plotlyOutput("knowledge"),
title = "Knowledge",
width = NULL
)
),
column(
width = 6,
box(
selectInput(
inputId = "select_urgency_input",
label = "Select statement",
choices = urgency_response_list,
selected = urgency_response_list[1]),
selectInput(
inputId = "urgency_subgroups",
label = "Select Demographic Subgroup(s) (Optional)",
choices = select_subgroups$subgroup,
selected = NULL,
multiple = TRUE
),
plotlyOutput("urgency"),
title = "Urgency",
width = NULL
)
)
),
fluidRow(
column(
width = 6,
box(
numericInput(
inputId = "select_topsources",
label = "Select number of most trusted sources to display",
value = 5, max = 11, min = 3, step =1
),
selectInput(
inputId = "sources_select_subgroups",
label = "Select Demographic Subgroup",
choices = select_subgroups$subgroup,
selected = "Overall Population"
),
plotlyOutput("sources"),
title = "Sources of Information",
width = NULL
)
),
column(
width = 6,
box(
selectInput(
inputId = "select_negative_impact_input",
label = "Select response(s) (Optional)",
choices = negative_impact_response_list,
selected = NULL,
multiple = TRUE),
selectInput(
inputId = "negative_impact_subgroups",
label = "Select Demographic Subgroup(s) (Optional)",
choices = select_subgroups$subgroup,
selected = "Overall Population",
multiple = TRUE
),
plotlyOutput("negative_impact"),
title = "Negative Impact",
width = NULL
)
)
)
)
)
)
shinyApp(ui, server)
View(scs_data_cleaned)
parameters_list <- scs_data_cleaned |>
pull(demographic_parameter) |>
unique()
runApp('dashboard')
runApp('dashboard')
setwd("C:/Users/danii/Desktop/R Workplace/shiny_training/dashboard")
runApp()
../data
getwd()
runApp()
runApp()
setwd("C:/Users/danii/Desktop/R Workplace/shiny_training/dashboard")
shiny::runApp()
shiny::runApp('dashboard')
runApp('dashboard')
runApp('dashboard')
runApp('dashboard')
runApp('dashboard')
getwd()
shiny::runApp('R/dashboard')
sheets <- c("T1", "T3", "T7", "T11")
source("C:/Users/danii/Desktop/R Workplace/R-Shiny_Dashboard-Views_on_Climate_Change/R/data_preparation.R", echo = TRUE)
library(readxl)
library(tidyverse)
library(stringr)
variables <- c(
"response_category",
"overall",
"sex_man",
"sex_woman",
"age_16_34",
"age_35_54",
"age_55_69",
"age_70_and_above",
"age_35_and_above",
"age_under_55",
"area_urban",
"area_rural",
"area_urban_large",
"area_urban_other",
"area_small_towns_accessible",
"area_small_towns_remote",
"area_rural_accessible",
"area_rural_remote",
"energyhub_yes",
"energyhub_no",
"floodrisk_yes",
"floodrisk_no",
"education_no_formal",
"education_other",
"education_graduate",
"education_non_graduate",
"work_employed",
"work_unemployed",
"work_retired",
"income_less_26000",
"income_26000_52000",
"income_less_than_52000",
"income_52000_and_above",
"mode_online",
"mode_postal",
"mode_total_unweighted",
"mode_online_unweighted",
"mode_postal_unweighted"
)
clean_scs_sheet <- function(sheet_name) {
# --- Import raw sheet (read-only) ---
scs_data_24 <- read_excel(
"data/scottish_climate_survey_2024.xlsx",
col_names = variables,
skip = 15,  # Skip metadata rows
sheet = sheet_name
)
# --- Remove unweighted mode columns (not required for analysis) ---
scs_data_24_clean <- scs_data_24 |>
select(-starts_with("mode"))
# --- Remove empty rows ---
scs_data_24_clean <- scs_data_24_clean |>
filter(!is.na(response_category))
# --- Keep rows only up to "Prefer not to say"
# Assumes this is the final valid response option ---
scs_data_24_clean <- scs_data_24_clean |>
slice(1:(which(response_category == "Prefer not to say")[1]))
# --- Add question identifier for traceability ---
scs_data_24_clean |>
mutate(question_number = sheet_name) |>
select(question_number, everything())
}
sheets <- c("T1", "T3", "T7", "T11")
scs_data <- sheets |>
lapply(clean_scs_sheet) |>
bind_rows()
scs_data_long <- scs_data |>
pivot_longer(
cols = overall:income_52000_and_above,
names_to = "demographic_parameter_subgroup",
values_to = "responders_n"
)
# Split demographic parameter from subgroup
scs_data_long <- scs_data_long |>
separate(
demographic_parameter_subgroup,
c("demographic_parameter", "subgroup"),
"_",
extra = "merge"
)
View(scs_data_long)
scs_data_base_sub_total <- scs_data_long |>
filter(str_detect(response_category, "^Base")) |>
select(-response_category) |>
rename(base_sub_total = responders_n)
# Remove Base rows from main dataset
scs_data_long <- scs_data_long |>
filter(!str_detect(response_category, "^Base"))
# Join denominator back into dataset
scs_data_cleaned <- scs_data_long |>
left_join(
scs_data_base_sub_total,
join_by(question_number, demographic_parameter, subgroup)
)
# Remove intermediate objects to keep environment clean
rm(list = c("scs_data_long", "scs_data_base_sub_total"))
source("C:/Users/danii/Desktop/R Workplace/R-Shiny_Dashboard-Views_on_Climate_Change/R/data_preparation.R", echo = TRUE)
runApp('R/dashboard')
View(scs_data_cleaned)
source("C:/Users/danii/Desktop/R Workplace/R-Shiny_Dashboard-Views_on_Climate_Change/R/data_preparation.R", echo = TRUE)
runApp('R/dashboard')
runApp('R/dashboard')
runApp('R/dashboard')
runApp('R/dashboard')
runApp('R/dashboard')
runApp('R/dashboard')
runApp('R/dashboard')
runApp('R/dashboard')
runApp('R/dashboard')
runApp('R/dashboard')
runApp('R/dashboard')
runApp('R/dashboard')
